---
title: Supabaseë¡œ ê°œë°œì ë¬¸ì„œ Feedback Widget êµ¬ê±°í•˜ê¸°
date: '2023-11-07'
tags: ['engineering', 'docs', 'data', 'react']
summary: ìœ ì € í”¼ë“œë°±ì„ ì›í•˜ì§€ë§Œ ë¬´ë£Œë¡œ êµ¬í˜„í•˜ê³  ì‹¶ì–´
---
## 1. ì™œ Feedback Widgetì´ í•„ìš”í•œê°€?

ê°œë°œì ë¬¸ì„œë„ í•˜ë‚˜ì˜ ì œí’ˆì´ë¼ê³  ìƒê°í•´ë³´ë©´ ìœ ì € í”¼ë“œë°±ì„ ìˆ˜ì§‘í•˜ê³  í•´ì„í•´ì„œ ë°˜ì˜í•˜ëŠ” ê³¼ì •ì´ ë¹ ì§ˆ ìˆ˜ ì—†ë‹¤.
ê°œë°œì ë¬¸ì„œì˜ ìœ ì € ë°ì´í„° ë° ë©”íŠ¸ë¦­ì„ ìˆ˜ì§‘í•˜ëŠ” ë°©ë²•ì—ëŠ” ì—¬ëŸ¬ê°€ì§€ê°€ ìˆë‹¤.

- [Google Analytics](https://analytics.google.com/), [Umami](https://umami.is/) ë“±ì˜ ì›¹ ë¶„ì„ íˆ´
- [Algolia](https://www.algolia.com/) ë“±ì˜ ê²€ìƒ‰ ë¶„ì„ íˆ´
- [LuckyOrange](luckyorange.com) ë“±ì˜ íˆíŠ¸ë§µ / í”½ì…€ íŠ¸ë˜ì»¤
- Feedback Widget

ë‹¤ë¥¸ íˆ´ë„ ì¢‹ì€ ì¸ì‚¬ì´íŠ¸ë¥¼ ë½‘ì„ ìˆ˜ ìˆì§€ë§Œ Feedback Widgetì€ íŠ¹ì • í˜ì´ì§€ ë³„ ì‹¤ì œ ìœ ì €ì˜ í”¼ë“œë°±ì„ ë“¤ì„ ìˆ˜ ìˆëŠ” ì¢‹ì€ ì±„ë„ì´ë‹¤.
Feedback Widgetì€ ë‹¤ìŒê³¼ ê°™ì´ ë³´í†µ ë¬¸ì„œ í•˜ë‹¨ì— ë¶™ì–´ `Is this page helpful?`ì„ ë¬»ëŠ” ìœ„ì ¯ì´ë¼ê³  ìƒê°í•˜ë©´ ëœë‹¤. [React Native](https://reactnative.dev/docs/getting-started), [GitBook](https://docs.gitbook.com/) ë“±ì˜ ì—¬ëŸ¬ ë¬¸ì„œì—ì„œ ì‰½ê²Œ ì°¾ì•„ë³¼ ìˆ˜ ìˆë‹¤.

![rn](/static/images/231107-feedback-widget/rn.png)

![gitbook](/static/images/231107-feedback-widget/gitbook.png)

ìš°ë¦¬ íšŒì‚¬ì—ì„œëŠ” êµ¬ì²´ì ì¸ í˜ì´ì§€ ì»¨í…ì¸  ê°œì„ ì— ë„ì›€ì´ ë  ê²ƒì„ ê¸°ëŒ€í•˜ê³  Feedback Widgetì„ ì ìš©í•´ë³´ìëŠ” ì•„ì´ë””ì–´ê°€ ë‚˜ì™”ë‹¤.


## 2. ì˜ì‚¬ ê²°ì •
Feedback widgetì„ êµ¬í˜„í•˜ëŠ” ë°ëŠ” ì—¬ëŸ¬ ë°©ë²•ì´ ìˆë‹¤. ë‹¹ì‹œ í‰ê°€ ê¸°ì¤€ì€ 1) ë¬´ë£Œì—¬ì•¼ í–ˆê³  2) ì‹¤ì‹œê°„ìœ¼ë¡œ ë°ì´í„°ë¥¼ ë³¼ìˆ˜ ìˆì–´ì•¼ í–ˆê³  3) ììœ ë„ê°€ ë†’ì•„ì•¼ í–ˆë‹¤.
ìš°ë¦¬ê°€ ì“°ê³  ìˆëŠ” í”„ë ˆì„ì›Œí¬ì¸ [Docusaurus](https://docusaurus.io/)ì—ì„œ ìì²´ì ìœ¼ë¡œ ì§€ì›ë˜ëŠ” ê±´ ì•„ì§ ì—†ì—ˆëŠ”ë°, ì´ ì£¼ì œë¥¼ ê°€ì§€ê³  [Feature Request ê²Œì‹œíŒ](https://docusaurus.io/feature-requests/p/feedback-widget)ì—ì„œ ë§¤ìš° ê¸´ í† ë¡ ì´ ì§„í–‰ë˜ëŠ” ì¤‘ì´ì—ˆë‹¤.
ë¦¬ì„œì¹˜ë¥¼ í†µí•´ íƒìƒ‰í•œ ì˜µì…˜ì€ ë‹¤ìŒê³¼ ê°™ì•˜ë‹¤.
- [FeedbackRocket](https://www.feedbackrocket.io/integration-guides/docusaurus) - ìœ ë£Œì„
- [HappyReact](https://happyreact.com/blog/feedback-widget-in-docusaurus) - ë¬´ë£Œì´ë‚˜, ì ê·¹ì ìœ¼ë¡œ ê°œë°œë˜ê³  ìˆì§€ ì•ŠëŠ” ê²ƒ ê°™ì•˜ê³  logoë¥¼ ì œê±°í•˜ë ¤ë©´ ëˆì„ ì¤˜ì•¼ í–ˆìŒ
- ì§ì ‘ êµ¬í˜„í•˜ê¸°

ê²°ë¡ ì ìœ¼ë¡œëŠ” ì§ì ‘ êµ¬í˜„í•˜ê¸°ë¡œ ê²°ì •ì´ ëëŠ”ë° ì´ìœ ëŠ” ë‹¤ìŒê³¼ ê°™ì•˜ë‹¤.
- HappyReactë¥¼ ë¹ ë¥´ê²Œ PoC í•´ë´¤ëŠ”ë° í¬ê²Œ ë§Œì¡±ìŠ¤ëŸ½ì§€ ì•Šì•˜ë‹¤
- ì´ë¯¸ [Supabase](https://supabase.com/)ë¼ëŠ” íˆ´ì„ ì“°ê³  ìˆì—ˆê³  ì—°ë™í•˜ëŠ” ë°ì— ê°œë°œ ë‚œì´ë„ê°€ ê·¸ë ‡ê²Œ í¬ê²Œ ì–´ë ¤ì›Œë³´ì´ì§€ ì•Šì•˜ë‹¤
- ë¯¸ë˜ë¥¼ ìœ„í•´ì„œ ë‹¤ë¥¸ í”Œë«í¼ì— ì˜ì¡´í•˜ê¸° ì‹«ì—ˆë‹¤

## 3. êµ¬í˜„
ìµœì¢…ì ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì€ íŒŒì¼ì´ ìƒì„±ëœë‹¤. (css íŒŒì¼ë“¤ ì œì™¸)
- `src/components/Feedback/supabase.js` : Supabase clientë¥¼ ì •ì˜í•œë‹¤.
- `src/components/Feedback/index.js` : Feedback widgetì„ ì •ì˜í•œë‹¤.
- `theme/DocItem/Footer/index.js` : ê° ë¬¸ì„œ í˜ì´ì§€ í•˜ë‹¨ì— Feedback widgetì„ ì‚½ì…í•œë‹¤.

ë’¤ë¡œ ê°ˆìˆ˜ë¡ Optional Text Fieldê°€ ìƒê¸°ëŠ” ë“± ê³ ë„í™”ê°€ ë˜ì—ˆì§€ë§Œ ì—¬ê¸°ì„œëŠ” ì´í•´ë¥¼ ë•ê¸° ìœ„í•´ ì´ˆê¸° ë””ìì¸ ì¤‘ì‹¬ìœ¼ë¡œ ì„¤ëª…í•´ë³´ë ¤ê³  í•œë‹¤.

### 3.1 Supabase ì„¤ì •
Supabaseì— ìƒˆë¡œìš´ í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•œë‹¤. Feedbackì„ ì €ì¥í•  ìˆ˜ ìˆëŠ” Tableì„ ìƒì„±í•œë‹¤. ì•„ì£¼ ê°„ë‹¨í•˜ê²ŒëŠ” ë‹¤ìŒê³¼ ê°™ì„ ê²ƒì´ë‹¤.
ì–¸ì œ ì–´ë–¤ í˜ì´ì§€ì—ì„œ ì–´ë–¤ ë¦¬ì•¡ì…˜ì´ ë°œìƒí–ˆëŠ”ì§€ë¥¼ ì €ì¥í•œë‹¤.
```
id uuid not null default gen_random_uuid (),
created_at timestamp with time zone not null default now(),
page text null,
reaction text null,
constraint reaction_feedback_pkey primary key (id)
```

ë‹¤ìŒìœ¼ë¡œëŠ” í…Œì´ë¸”ì— ëŒ€í•´ì„œ [RLS(Row Level Security)](https://supabase.com/docs/learn/auth-deep-dive/auth-row-level-security) ì •ì±…ì„ ë‹¤ìŒê³¼ ê°™ì´ ì„¤ì •í•œë‹¤.
ê¸°ë³¸ì ìœ¼ë¡œ ì‚¬ì´íŠ¸ë¥¼ ë°©ë¬¸í•˜ëŠ” ëª¨ë“  ìœ ì €ê°€ insertë¥¼ í• ìˆ˜ ìˆì–´ì•¼ í•˜ì§€ë§Œ ì–´ë“œë¯¼ë§Œ ë°ì´í„°ë¥¼ ì½ì„ìˆ˜ ìˆì–´ì•„ í–”ë‹¤.

![rls](/static/images/231107-feedback-widget/rls.png)

ë§ˆì§€ë§‰ìœ¼ë¡œ `supabase.js`ì—ì„œ ë‹¤ìŒê³¼ ê°™ì´ supabase í´ë¼ì´ì–¸íŠ¸ë¥¼ ì„¤ì •í•œë‹¤. `index.js`ì—ì„œ ì´ ë¶€ë¶„ì„ ëŒì–´ë‹¤ ì“¸ ê²ƒì´ë‹¤.
```js
import { createClient } from "@supabase/supabase-js";

const supabaseUrl = "<supabaseUrl>";
const supabaseKey = "<supabaseKey>";

export const supabase = createClient(supabaseUrl, supabaseKey);

export default supabase;
```

### 3.2 Feedback Widget ì •ì˜

`index.js`ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ì„¤ì •í•œë‹¤.

```js
import React, { useState } from "react";
import { supabase } from "./supabase";
import styles from "./styles.module.css";

const Feedback = ({ page }) => {
  const [reaction, setReaction] = useState(null);

  const handleReaction = async (selectedReaction) => {
    console.log("Button clicked:", selectedReaction);
    try {
      const { data, error } = await supabase.from("feedback").insert([
        {
          page: window.location.href,
          reaction: selectedReaction,
        },
      ]);

      if (error) {
        console.error("Error submitting feedback:", error);
        return;
      }

      setReaction(selectedReaction);
    } catch (error) {
      console.error("Error submitting feedback:", error);
    }
  };

  return (
    <div className={styles.feedbackWidget}>
      {reaction === null ? (
        <div className={styles.reactionButtons}>
          <h3>Is this page helpful?</h3>
          <button className={styles.reaction} onClick={() => handleReaction("thumbs_up")}>ğŸ‘</button>
          <button className={styles.reaction} onClick={() => handleReaction("thumbs_down")}>ğŸ‘</button>
        </div>
      ) : (
        <div className={styles.feedbackMessage}>
          Thanks for your feedback!
        </div>
      )}
    </div>
  );
};

export default Feedback;
```

ìœ ì €ì˜ Feedbackê³¼ í˜„ì¬ í˜ì´ì§€ ì£¼ì†Œë¥¼ ë°›ì•„ì„œ Supabase Clientì˜ Tableì— Insertí•˜ëŠ” ê²ƒì„ì„ ì•Œìˆ˜ ìˆë‹¤.
ìœ ì €ê°€ ë¦¬ì•¡ì…˜ì„ í•´ì£¼ë©´ **Thank you for your feedback!** ì´ë¼ëŠ” ë¬¸êµ¬ë„ ë‚ ë ¤ì¤€ë‹¤.

### 3.3 Doc Footer ì •ì˜
í•´ë‹¹ í”¼ë“œë°± ìœ„ì ¯ì€ ëª¨ë“  ê°œë³„ ë¬¸ì„œ í˜ì´ì§€ì˜ í•˜ë‹¨ì— ë“¤ì–´ê°€ì•¼ í•œë‹¤. ë”°ë¼ì„œ `theme/DocItem/Footer/index.js`ì— DocItemFooter ì•ˆì— Feedback Widgetì„ ë‹¤ìŒì²˜ëŸ¼ ì„ ì–¸í•œë‹¤.
```js
import Feedback from "../../../components/Feedback";
...

export default function DocItemFooter() {
  ...
  return (
    <>
      <Feedback resource={unversionedId} />
      ...
    </>
  );
}
```

ì—¬ê¸°ê¹Œì§€ë§Œ êµ¬í˜„í•´ë„ ì‹¤ì œ ìœ ì €ì˜ í”¼ë“œë°±ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë°›ì„ ìˆ˜ ìˆë‹¤.
ë’¤ë¡œ ê°ˆìˆ˜ë¡ ìœ„ì ¯ì˜ ë””ìì¸ë„ ê°œì„ ë˜ê³  ë”°ë´‰ì„ ëˆŒë €ì„ ë•Œ Optionalí•˜ê²Œ í”¼ë“œë°±ì„ ì œê³µí•  ìˆ˜ ìˆëŠ” Text Fieldë„ ì¶”ê°€ë˜ì—ˆë‹¤. ìµœì¢… PRì€ [ì—¬ê¸°](https://github.com/datahub-project/datahub/pull/8732)ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

## 4. ê²°ê³¼

ê²°ê³¼ì ìœ¼ë¡œ ì´ëŸ° ë½€ì§í•œ Feedback Widgetì´ [ëª¨ë“  í˜ì´ì§€ í•˜ë‹¨](https://datahubproject.io/docs/quickstart#performance--management)ì— ë“¤ì–´ê°€ê²Œ ë˜ì—ˆë‹¤.

![dh](/static/images/231107-feedback-widget/dh.png)

ì§§ì€ ì‹œê°„ì— ê¸°íšë¶€í„° ì‹¤ì œ êµ¬í˜„, ë°°í¬, ë°ì´í„° ìˆ˜ì§‘ê¹Œì§€ í•´ë³¼ìˆ˜ ìˆì–´ì„œ í¥ë¯¸ë¡œìš´ í”„ë¡œì íŠ¸ì˜€ë‹¤. Supabaseì— ì‹¤ì œ í”¼ë“œë°± ë°ì´í„°ê°€ ìŒ“ì´ëŠ” ê²ƒë„ ì¬ë°Œì—ˆë‹¤.
ë‚¨ì€ ê³¼ì œë¼ë©´ ì‹¤ì œë¡œ ì´ Widgetì„ ì‹¤ì œë¡œ ì–¼ë§ˆë‚˜ ë§ì€ ìœ ì €ë“¤ì´ ì‚¬ìš©í•˜ê²Œ í•  ê²ƒì¸ì§€ì¸ë° ì´ê±´ ì¸ì§€ì ìœ¼ë¡œ í’€ì–´ê°€ì•¼ í•˜ëŠ” ë¬¸ì œê°€ ì•„ë‹Œê°€ ì‹¶ë‹¤.
